---
layout: post
title: 堆溢出之unlink
excerpt: "sploitfun系列教程之3.1 堆溢出之unlink"
categories: [sploitfun系列教程]
comments: true
---

漏洞代码如下
```c
/* 
 Heap overflow vulnerable program. 
 */
#include <stdlib.h>
#include <string.h>

int main( int argc, char * argv[] )
{
        char * first, * second;

/*[1]*/ first = malloc( 666 );
/*[2]*/ second = malloc( 12 );
        if(argc!=1)
/*[3]*/         strcpy( first, argv[1] );
/*[4]*/ free( first );
/*[5]*/ free( second );
/*[6]*/ return( 0 );
}
```
第三部分的代码存在堆溢出，用户输入的`argv[1]`没有长度限制，会覆盖到第二个chunk，可能会造成代码执行