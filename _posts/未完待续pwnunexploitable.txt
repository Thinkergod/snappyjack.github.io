

```
file unexploitable 
unexploitable: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=aba2c1fb7a4bca286d75e23006f9fe01dfcb03c2, not stripped

```

ida打开,看到典型的栈溢出,offset为`0x10+8 = 24`
```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char buf; // [sp+0h] [bp-10h]@1

  sleep(3u);
  return read(0, &buf, 0x50FuLL);
}
```
ROPgadget似乎存在一个缺陷，无法把单独的syscall识别成一个gadgetROPgadget无法查找到syscall,我们使用ropper来查找

使用ropper查找gadget
```
ropper -f unexploitable |grep syscall
/usr/lib64/python2.7/site-packages/cffi/cparser.py:164: UserWarning: Global variable 'r' in cdef(): for consistency with C it should have a storage class specifier (usually 'extern')
  "(usually 'extern')" % (decl.name,))
[INFO] Load gadgets from cache
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
0x0000000000400560: syscall; 
```
使用`objdump -d unexploitable |less`查找read地址
```
0000000000400430 <read@plt>:
  400430:       ff 25 ca 0b 20 00       jmpq   *0x200bca(%rip)        # 601000 <read@GLIBC_2.2.5>
  400436:       68 00 00 00 00          pushq  $0x0
  40043b:       e9 e0 ff ff ff          jmpq   400420 <.plt>

```